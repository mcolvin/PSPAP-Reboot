<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>Generating AM Sub-Objective Metrics</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/font-awesome-4.5.0/css/font-awesome.min.css" rel="stylesheet" />




<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 66px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 71px;
  margin-top: -71px;
}

.section h2 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h3 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h4 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h5 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h6 {
  padding-top: 71px;
  margin-top: -71px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->






<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">PSPAP-V2</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li>
  <a href="posts.html">
    <span class="fa fa-pencil-square-o"></span>
     
    Posts
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Generating AM Sub-Objective Metrics</h1>

</div>


<!--
rmarkdown::render("_Report-2-06-estimating-population-values.Rmd",output_format='word_document')# build page
-->
<p>The need to redesign the PSPAP was triggered by the recognition that the current PSPAP may not allow evaluation of whether the pallid sturgeon fundamental objectives identified in the AM plan were achieved on an annual basis or estimated with any level of certainty. Specifically, sub-objectives listed in section 4.1.1. of the AM plan specify 1) increase pallid sturgeon recruitment to age-1, and 2) maintain or increase numbers of pallid sturgeon as an interim measure until sufficient and sustained natural recruitment occurs, both of which are needed to achieve the fundamental objective set by the USFWS to preclude species jeopardy. These two sub-objectives are redefined as fundamental objectives in the context of the monitoring program to detect and quantify recruitment to age-1 and quantify pallid sturgeon population trend and abundance.</p>
<p>Metrics to assess achievement of the first sub-objective (increase pallid sturgeon recruitment to age-1) are particularly challenging because of the rarity of the species and existing technical difficulties with capturing age-1 (and age-2, age-3) fish and in accurately determining ages. As direct assessment of recruitment to age-1 is unlikely to be successful, the PSPAP v. 2.0 process has proceeded with the assumption that recruitment will need to be assessed through estimates of abundance and trend of older fish, determination of hatchery or wild origin, and back-calculation of age-1 recruitment rates through a well-calibrated and validated population model. As reported in Section 4.1.1 of the AM plan, metrics for assessing the second sub-objective (maintain or increase numbers of pallid sturgeon as an interim measure) include population estimates for pallid sturgeon for all size and age classes, where age classes are estimated by the population model.</p>
<p>As indicated above, estimates of abundance and trend are key to assessing both of the AM plan pallid sturgeon sub-objectives, and therefore, both the generation and the assessment of abundance and trend estimates play a key role in this analysis. Here we focus on the generation of the abundance and trend estimates, i.e. the metrics for assessing the AM sub-objectives, leaving the assessment of these estimates to the following section.</p>
<!--
Generating abundance and trend estimates under a particular monitoring 
design occurs in two steps:

1. Simulate catch data using the sampling design prescribed by the 
given monitoring program, and
2. Calculate estimates from the catch data using the abundance and trend
estimators prescribed by the given monitoring program.

Since the simulation of catch data is stochastic and certain values 
(e.g., catchability) are uncertain, these steps were repeated several 
times for each monitoring design, generating a fuller picture of the 
range of outcomes that can be expected under a particular monitoring 
design.
-->
<div id="objectives" class="section level3">
<h3>Objectives</h3>
<p>The objectives of estimating population metrics are, for each monitoring design considered and for each of the catch data sets generated under the given monitoring design, to:</p>
<ol style="list-style-type: decimal">
<li>Generate an estimate of the average population trend over the 10-year period by basin,</li>
<li>Generate segment-level abundance estimates (as inputs for the collaborative population model, PSPAP Fundamental Objective 3) by length class, and</li>
<li>Generate basin-level abundance estimates by aggregating segment-level estimates.</li>
</ol>
</div>
<div id="major-assumptions" class="section level3">
<h3>Major Assumptions</h3>
<p>We made the typical assumptions associated with the use of each individual estimator. In general, these assumptions match the assumptions used to generate the reference populations and simulate the catch data. Any major assumptions additional to those previously discussed are included in the discussion of the particular estimator to which it applies.</p>
<!--# Methods-->
</div>
<div id="scope-and-spatial-scale" class="section level3">
<h3>Scope and Spatial Scale</h3>
<p>Since accurately identifying fish age in the field is challenging and the AM plan specifies that age classes are to be estimated by the collaborative population model, we limit our current focus to overall population estimates for pallid sturgeon, as well as population estimates by size class.</p>
<p>Whenever possible, population abundance estimates were made at the bend level and then aggregated to the segment level; however, monitoring designs that employed the robust design abundance estimator had difficulty producing estimates at the bend spatial scale. Therefore, all monitoring designs using the robust design estimator directly estimated segment-level abundances.</p>
</div>
<div id="monitoring-design-estimators" class="section level3">
<h3>Monitoring Design Estimators</h3>
<p>Several capture-recapture estimators exist to estimate abundance, demographic rates, as well as abundance and demographic rates. A capture recapture estimator that simultaneously estimates demographic rates and abundance can potentially achieve metrics and targets specified in sub-objectives 1 and 2. Historically, a Jolly-Seber model, was used to simultaneously estimate abundance and survival from recapture of marked individuals from singular capture occasions over time (Jolly 1963, 1965, Seber 1965). However, the lack of multiple within primary occasion recapture attempts required potentially unrealistic assumptions to estimate capture probability. By considering monitoring designs that utilitze multiple recapture efforts (secondary occasions) within a sampling year (primary occasions), direct estimation of capture probability can be achieved, opening the door to the use of several mark- recapture estimators.</p>
<div id="abundance-estimators" class="section level4">
<h4>Abundance Estimators</h4>
<div id="minimum-known-alive" class="section level5">
<h5>Minimum Known Alive</h5>
<p>The minimum known alive (MKA) estimator is the most simplistic abundance estimator we considered. It does exactly what it sounds like: it uses the number of (unique) individuals captured in a bend as an estimate for the bend abundance. This estimator is expected to be very negatively biased, as, given low capture probabilities and reasonable effort, it is likely we catch only a small portion of the fish living in the bend. However, this estimator has its benefits:</p>
<ul>
<li>It does not require a mark-recapture program (i.e., it can be used with single occasion data), and therefore, should save on costs, and</li>
<li>It can be used with mark-recapture program data when more sophisticated estimators fail to produce estimates.</li>
</ul>
<p>For these reasons, we ran the MKA estimator under all monitoring program sampling designs, allowing us to compare it to all other estimators. For single occasion data, the bend level abundance estimate is the same as the number of fish caught in the bend. For multiple occasion data, PIT tag identification of the fish caught will be necessary. Using PIT tag information, it can be determined if any fish were caught multiple times (in different occasions). Each fish that was caught will be counted only once, whether or not it was caught during more than one occasion. The total number of unique fish known to be alive in the bend, as determined from PIT tag identification, serves as the estimate for bend abundance.</p>
<p>Assuming PIT tag identification is always reliable, then the MKA abundance estimate is always clear and estimate standard error is 0 at the bend level. However, non-zero standard errors were calculated when we aggregate bend level estimates to the segment or basin levels (See Aggregating bend level abundance to segment level).</p>
</div>
<div id="closed-mark-recapture-estimators-m_0-and-m_t" class="section level5">
<h5>Closed mark-recapture estimators, M<span class="math inline">\(_0\)</span> and M<span class="math inline">\(_t\)</span></h5>
<p>The closed mark-recapture estimators take advantage of multiple capture occasions within a year to estimate both capture probability and abundance. The two estimators differ in the way they treat capture probability. The M<span class="math inline">\(_0\)</span> estimator assumes that the capture probability is constant across all capture occasions (<span class="math inline">\(p\)</span>). The M<span class="math inline">\(_t\)</span> estimator assumes that capture probability varies within a year from occasion to occasion (<span class="math inline">\(p_t\)</span>).</p>
<p>In reality, we can expect capture probability to vary from occasion to occasion due to many factors (e.g., water velocity, temperature); however, if fluctuations in capture probability are expected to be small, then capture probability may best be modelled as a constant with some environmental noise. In this case, the M<span class="math inline">\(_0\)</span> estimator is likely the best choice of the two. On the other hand, if different gears are used during each capture occasion and we expect that the different gears will have a large difference in capture probability, then the M<span class="math inline">\(_t\)</span> estimator may be the better choice. In any of these cases there may be a tradeoff between estimating more parameters (multiple capture probabilities) and the bias and precision of thes pararmeter estimates. Therefore, we implemented both the M<span class="math inline">\(_0\)</span> and the M<span class="math inline">\(_t\)</span> estimators in all scenarios and compared their outcomes.</p>
<p>Both the M<span class="math inline">\(_0\)</span> and M<span class="math inline">\(_t\)</span> estimators rely on the assumption that the population is closed across capture occasions; in other words no fish moves into the sampled bend or out of the sampled bend during the time period between the start of the first capture occasion to the end of the last within year capture occasion. In the analysis of monitoring programs presented here, this assumption will hold as it was one of the assumptions used to generate the reference population. This allows us to evaluate the performance of these estimators under the best of circumstances. If they do not perform well in these circumstances, then it is unlikely they will perform well in others.</p>
<p>We assumed a single capture occasion will be approximately a 24-hour time period, so for the case of actually sampling pallid sturgeon in the Missouri River, we would want this assumption of no movement to approximately hold for at least a few days. Additionally, since it is likely this assumption will not be met consistently in the field, we have looked at the consequences of breaking the assumpiton of closure across capture occasions (See ??).</p>
<p>We ran the M<span class="math inline">\(_0\)</span> and M<span class="math inline">\(_t\)</span> estimators in R using the <span class="math inline">\(\texttt{closedp.t}\)</span> function in the <span class="math inline">\(\texttt{Rcapture}\)</span> package, obtaining bend abundance estimates and estimate standard error. Any estimator results that gave estimates but produced warnings (e.g., nonconvergence, extremely large asymptotic bias) were excluded from the analysis (with the exception that the inability of the estimator to produce estimates is considered in estimator utility).</p>
<p>The M<span class="math inline">\(_0\)</span> and M<span class="math inline">\(_t\)</span> estimators only analyze the data from within a year and do not compare data across years. Therefore, while these estimators can produce estimates of capture probability and annual bend level abundance, they cannot estimate annual survival or recruitment.</p>
</div>
<div id="robust-design" class="section level5">
<h5>Robust Design</h5>
<p>The robust design estimator (RD) takes the analysis of capture recapture data a step further than the closed mark-recapture estimators described above. It uses multiple capture occasions within a year, as well as comparing capture data across years in order to directly estimate capture probability, abundance, and survival as described by Pollock {Pollok 1982}.</p>
<p>The robust design frame work has been applied across a wide range of taxa to estimate demographic rates and population abundance. Its use has been extended to studies of species occurrence (i.e., occupancy models; {MacKenzie et al. 2002, Tyre et al. 2003}) and abundance (N-mixture models; {Royle 2004b, Royle 2004a}) of unmarked individuals. The robust design provides a rigorous framework that allows for the estimation of relevant demographic rates and abundance using marked individuals. As originally described by Pollock {1982}, a robust design consists of primary sampling occasions (e.g., years) with secondary sampling occasions nested within each primary occasion (Figure 1). Primary occasions are spaced temporally to capture processes like survival and growth. Secondary occasions occur over a short time frame, short enough that closure of the population from demographic processes (i.e., recruitment, mortality, immigration, emigration) can be assumed. The secondary sampling occasions provide multiple opportunities for individuals to be captured and thereby allowing capture probability and abundance to be estimated.</p>
<p>The use of a robust design capture recapture approach to estimate Missouri River pallid sturgeon abundance, and demographic rates are not novel. The first application was Steffensen et al. (2012) as part of the annual brood stock collection in segment 9. Similarly, Winders and Steffensen (2014) used a robust design to estimate abundance and demographic rates for a portion of segment 10 using broodstock collection data. In both studies, pallid sturgeon were captured by setting multiple trotlines at random locations in the study area over a short period. The annual brood stock sampling was the primary occasion and daily capture efforts were the secondary occasions in both studies. Given the study design, survival was estimated over the open period (i.e., between annual broodstock collection events). Capture probability was estimated for each daily effort within the primary period and abundance during the closed period (i.e., broodstock collection). Additionally, both studies were able to estimate movement parameters that account for pallid sturgeon leaving or arriving in the study area between closed periods.</p>
<p>There are variations of the robust design that estimate alternative sets of parameters. The most commonly used version, as well as the version used by Steffensen et al. (2012) and Winders and Steffensen (2014) is the version that estimates 6 parameters. Specifically these parameters are:</p>
<ul>
<li><span class="math inline">\(\varphi\)</span>: the probability of surviving between primary occasions,</li>
<li><span class="math inline">\(\gamma^{\prime}\)</span>: the probability of being outside the study area and unavailable for capture during the primary occasions given the animal was not present during the previous primary occasions given it survives to the current occasion (Figure 2),</li>
<li><span class="math inline">\(\gamma^{\prime\prime}\)</span>: is the probability of being outside the study area and unavailable for capture during the primary occasions given the animal was present during the previous primary occasions given it survives to the current occasion (Figure 2),</li>
<li><span class="math inline">\(c\)</span> is the initial capture probability,</li>
<li><span class="math inline">\(p\)</span> is the recapture probability, and</li>
<li><span class="math inline">\(f_0\)</span> is number of unobserved individuals.</li>
</ul>
<p>Depending on the situation the number of parameters estimated can be reduced by assuming initial capture probability is equal to recapture probability where <span class="math inline">\(c=p\)</span>. Similarly, <span class="math inline">\({{\gamma }^{\prime }}\)</span> and <span class="math inline">\(\gamma^{\prime\prime}\)</span> can be specified to represent hypotheses about immigration and emigration processes. For example, even flow of fish in and out of the systems can be specified by imposing equality of immigration and emigration terms where <span class="math inline">\({{\gamma }^{\prime }}={{\gamma }^{\prime \prime }}\)</span>. Population abundance (<span class="math inline">\(N\)</span>) at each time period is a derived parameter calculated as: <span class="math inline">\(N={{f}_{0}}+M\)</span> where, <span class="math inline">\(M\)</span> is the number of marked fish. Uncerainty around derived parameter estimates can be estimated by profile likelihood and use of the delta method if estimated by maximizing the likelihood of the model given the data {Hilborn and Mangel 1997, Powell 2012}. Uncertainty can also be quantified simultaneously for estimated and derived parameters if fit by MCMC using a Bayesian approach.</p>
<p>We used what is known as the closed robust design multi-state model (CRDMS). Between year movment from bend to bend or segment to segment may lead to individuals being collected in one sampling area (i.e., state) one year and another sampling area a future year. A multi-state model takes into consideration this movement by looking at and comparing capture histories from all connected states, allowing the estimation of transistion probabilities, or the probability that a fish moves from one state to another. In this case, all the parameters listed above are estimated, with the exception of the two gamma parameters (<span class="math inline">\(\gamma&#39;\)</span> and <span class="math inline">\(\gamma&#39;&#39;\)</span>), as movement into and out of the sampling (or observable area) is now taken into account with the transition probabilities:</p>
<ul>
<li><span class="math inline">\(\psi_{ij}\)</span>: the transition from state <span class="math inline">\(i\)</span> to state <span class="math inline">\(j\)</span>, where a state is either a sampling unit or the unobservable area outside all sampling units.</li>
</ul>
<p>For example, if we sample segments 7-10,13 and 14 in the lower Missouri, the multi-state model will provide transition probabilities from each of these segments to each of the other segments, as well as transition probabilities to an unobservable area (e.g. temporary migration to the Platte or Mississippi).</p>
<p>We attempted to run the CRDMS model through R using Program MARK at the bend level (where each observable state would be a sampled bend); however, either the capture history data available (lack of enough recaptures), the computation time needed, or the memory needed caused issues with obtaining estimates from the estimator. We were, however, able to run the estimator at the segment level, running seperate estimates for each basin since basins are assumed unconnected by natural movement. This allowed for the estimation of segment level abundances and transition probabilities, as well as basin level annual survival and capture probability, where we assumed capture and recapture probabilities were equivalent (i.e, <span class="math inline">\(c=p\)</span>).</p>
</div>
</div>
<div id="trend-estimators" class="section level4">
<h4>Trend Estimators</h4>
<p>We defined trend as the population growth rate <span class="math inline">\(\lambda\)</span>, which describes how quickly the population is either growing (<span class="math inline">\(\lambda&gt;1\)</span>) or declining (<span class="math inline">\(\lambda&lt;1\)</span>) each year. Trend, therefore, takes into account both survival and recruitment.</p>
<div id="abundance-based-estimators" class="section level5">
<h5>Abundance Based Estimators</h5>
<p>In general, we can define population growth as <span class="math display">\[N_t=\lambda^t N_0,\]</span> where <span class="math inline">\(N_t\)</span> is the population size in year <span class="math inline">\(t\)</span> and <span class="math inline">\(N_0\)</span> is the initial population size. If we take the natural logarithm of both sides of this equation we find <span class="math display">\[\ln(N_t)=\ln(\lambda)\cdot t + \ln(N_0).\]</span> In other words, abundance on a log-scale is a linear model with a slope directly related to <span class="math inline">\(\lambda\)</span>. We use this relationship to our advantage, fitting a linear model to the log-transformed segment level estimated abundances in order to estimate the average population trend, <span class="math inline">\(\lambda\)</span>. In particular we fit the model</p>
<p><span class="math display">\[\log(abundance)\sim segment+year,\]</span></p>
<p>taking into account the effect segment has on the relationship.</p>
<p>This model was fit to segment level abundance estimates generated by each of the abundance estimators described above, resulting in 7 abundance based trend estimators (2 for each of MKA, M<span class="math inline">\(_0\)</span>, and M<span class="math inline">\(_t\)</span>— see Aggregating bend level abundance to segment level—and one for the CRDMS, or robust design estimator). The estimated slope (<span class="math inline">\(\hat{\beta}\)</span>) of the linear model and its standard error, were then used to estimate the average trend: <span class="math display">\[\hat{\lambda}=e^{\hat{\beta}}\]</span> with standard error <span class="math display">\[e^{\hat{\beta}}\cdot SE(\beta),\]</span> as calculated using a first order approximation under the delta method, where <span class="math inline">\(SE(\beta)\)</span> is the standard error of the slope estimate <span class="math inline">\(\beta\)</span>.</p>
</div>
<div id="catch-effort" class="section level5">
<h5>Catch Effort</h5>
<p>The catch effort estimator assumes that catch per unit effort (CPUE) is proportional to abundance, which is indeed as we modeled it in the catch data: <span class="math display">\[C=qfN,\]</span> where <span class="math inline">\(C\)</span> is catch, <span class="math inline">\(q\)</span> is catchability described as the probability of capturing a single fish with one unit of effort, <span class="math inline">\(f\)</span> is effort (in this case, measured in minutes of gear deployment), and <span class="math inline">\(N\)</span> is abundance. Therefore, we would expect CPUE (or <span class="math inline">\(C/f\)</span>) to be proportional to abundance. Consequently, the log-transformed CPUE is also a linear function of the log-transformed growth rate, <span class="math inline">\(\lambda\)</span>, justifying the use of the same approach as in the case of abundance, but instead fitting the linear model</p>
<p><span class="math display">\[\log(\mbox{CPUE})\sim segment+year,\]</span></p>
<p>to the segment level catch effort data. One issue with this approach, however, is that zero catch values cannot be log-transformed. To avoid problems that arise due to zero catch values the Catch Effort Trend estimator instead adjusts the CPUE by adding one to the catch prior to dividing by the effort, i.e., <span class="math display">\[\tilde{\mbox{CPUE}}=\frac{C+1}{f}   \hspace{0.5cm} \mbox{ and } \hspace{0.5cm}
\log(\tilde{\mbox{CPUE}})\sim segment+year.\]</span></p>
<p>It is from this linear model that the estimate for <span class="math inline">\(\lambda\)</span> and its standard error are calculated, using the same equations described for the abundance based trend estimators above.</p>
</div>
<div id="pradel" class="section level5">
<h5>Pradel</h5>
<p>When capture recapture histories are viewed in reverse order recruitment can be estimated using what is referred to as a Pradel model (Pradel 1996). This model relies on being able to differentiate recruits based off of size or age which works well for fish populations. Therefore there are 2 processes in which a pallid sturgeon can be initially captured: 1) it is a new recruit and was not vulnerable to capture and 2) the pallid sturgeon was vulnerable to capture but not captured. The differentiating the 2 outcomes can be informed by size to improve recruitment estimates.</p>
<p>In addition to estimating recruitment the Pradel estimator can also estimate survival, allowing for an estimation of population trend to be derived.</p>
</div>
<div id="direct-estimation-from-robust-design" class="section level5">
<h5>Direct Estimation from Robust Design</h5>
<p>While not commonly employed in fisheries literature the robust design can estimate population growth rate (<span class="math inline">\(\lambda\)</span>). In particular, by running capture histories backwards estimates the probability a pallid sturgeon was present in the previous year given it was present in the current year which is the per capita rate of additions to the population (<span class="math inline">\(f\)</span>), or the number of individuals entering the population between primary occasions. Survival rate (<span class="math inline">\(\varphi\)</span>) can be estimated, and by running them forward, survival can be estimated. Trend evaluated as population growth rate is derived from model estimates as <span class="math inline">\(\lambda =\varphi \text{+}f\)</span> and uncertainty can be estimated using the previously described approaches for<span class="math inline">\(N\)</span>.</p>
</div>
</div>
<div id="aggregating-bend-level-abundance-to-the-segment-level" class="section level4">
<h4>Aggregating Bend Level Abundance to the Segment Level</h4>
<p>The minimum known alive (MKA) and closed mark-recapture M<span class="math inline">\(_0\)</span> and M<span class="math inline">\(_t\)</span> estimators were ran to estimate abundance at the bend level. However, abundance estimates at the segment and basin levels are desired for use in PSPAP Objectives 3 and 2, respectively. Here we’ll discuss the aggregation of the MKA, M<span class="math inline">\(_0\)</span>, and M<span class="math inline">\(_t\)</span> abundance estimates to the segment level, leaving discussion of the basin level estimates to the next section.</p>
<p>Aggregation to the segment level was based on estimated bend level densities, or the estimated bend abundance divided by the bend length in river kilometers (rkm). We assume the segment density can be estimated by the average density of pallid sturgeon in the sampled bends within the segment. Therefore, the segment abundance can be estimated as the estimated segment density multiplied by the length (in rkm) of the segment.</p>
<p>In calculating the average density of pallid sturgeon in a segment we took two approaches for the purposes of comparing: arithmetic mean bend density and weighted mean bend density. While we expect the weighted mean approach to be more accurate, we suspect that the arithmetic mean is a commonly used approach, and therefore, wanted to highlight the differences between the two.</p>
<div id="arithmetic-mean-am" class="section level5">
<h5>Arithmetic Mean (AM)</h5>
<p>For the arithmetic mean method, we calculate the estimated densities of each sampled bend and then take the typical average (add up the densities and divide by the total number of bends sampled). This averaged density is used as an estimate of the segment density. The segment abundance is then calculated from the segment density estimate and segment length. Mathematically, the segment abundance estimate is calculated as <span class="math display">\[\hat{N_s}=\frac{\sum_i\left(\frac{\hat{N}_{s,i}}{L_{s,i}}\right)}{bends_s}\cdot L_s,\]</span> where <span class="math inline">\(\hat{N_s}\)</span> and <span class="math inline">\(L_s\)</span> are the estimated abundance and total length (in rkm) of segment <span class="math inline">\(s\)</span>, repsectively, <span class="math inline">\(\hat{N}_{s,i}\)</span> and <span class="math inline">\(L_{s,i}\)</span> is the estimated abundance and length (in rkm) of sampled bend <span class="math inline">\(i\)</span> within segment <span class="math inline">\(s\)</span>, respectively, and <span class="math inline">\(bends_s\)</span> is the number of sampled bends in segment <span class="math inline">\(s\)</span>.</p>
<p>A potential issue with the arithmetic mean is that it treats each bend as equivalent to any other bend, despite the fact that bends are of different lengths. To get a good understanding of how this can effect an estimate, let’s look at a simplified example with known abundances (i.e. perfect estimates). Assume that the segment consists of 4 bends with the abundances and lengths of each bend given in the table below.</p>
<table>
<thead>
<tr class="header">
<th align="left">Bend Abundance</th>
<th align="center">Bend Length (RKM)</th>
<th align="center">Bend Density (fish/RKM)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">30</td>
<td align="center">3</td>
<td align="center">10</td>
</tr>
<tr class="even">
<td align="left">45</td>
<td align="center">5</td>
<td align="center">9</td>
</tr>
<tr class="odd">
<td align="left">14</td>
<td align="center">7</td>
<td align="center">2</td>
</tr>
<tr class="even">
<td align="left">36</td>
<td align="center">12</td>
<td align="center">3</td>
</tr>
</tbody>
</table>
<p>If we wanted to find the average segment density we would add all bend abundances together to get a segment abundance of 125 and divide by the total of the bend lengths, or 27, giving us a segment density of 4.6296296 fish per rkm. This process is different from calculating the density of each bend and taking the mean of these densities, as the arithmetic mean (AM) approach would do. This approach estimates the segment density as 6 fish per rkm, or after multiplying by the segment length, the AM approach estimates that there are 162 fish in the segment when there are 125. While a difference of 37 may not seem large, keep in mind we were working with small bend abundances and a relatively small length of river (27 rkm). Larger bend abundances, like those simulated in the reference populations, and larger segment stretches can easily lead to larger differences in this calculation.</p>
<p>Even with perfect bend abundance knowledge, the arithmetic mean approach fails to calculate the segment abundance perfectly. The reason it fails is because the bends are of different lengths but treated the same (had they all been the same length, say 5, this approach would have worked!). A density of 3 fish per rkm means a lot more in terms of abundance when the bend length is 12 rkm (36 fish) versus 2 rkm (6 fish). As will be explained and shown below, in the case of perfect knowledge, the weighted mean approach will calculate the segment abundance correctly every time.</p>
</div>
<div id="weighted-mean-wm" class="section level5">
<h5>Weighted Mean (WM)</h5>
<p>The weighted mean estimator attempts to remedy the issues discussed in the previous example that can arise from treating all bends as equal by weighting the bend densities. In particular, the weight for a bend is the length of that bend relative to the total length of all sampled bends within the segment, or, <span class="math display">\[w_{s,i}=\frac{L_{s,i}}{\sum_{j \epsilon J} L_{s,j}},\]</span> where <span class="math inline">\(w_{s,i}\)</span> and <span class="math inline">\(L_{s,i}\)</span> are the weight and length of sampled bend <span class="math inline">\(i\)</span> in segment <span class="math inline">\(s\)</span>, respectively, and the set <span class="math inline">\(J\)</span> is the set of all sampled bends in segment <span class="math inline">\(s\)</span>.</p>
<p>The weighted mean density is then calculated as the sum of each bend density multiplied by its weight, or, <span class="math display">\[\hat{d}_s=\sum_{j \epsilon J} w_{i,s}\cdot \hat{d}_{i,s},\]</span> where <span class="math inline">\(\hat{d_s}\)</span> is the estimated segment density and <span class="math inline">\(\hat{d}_{i,s}=\hat{N}_{i,s}/L_{i,s}\)</span> is the estimated density of sampled bend <span class="math inline">\(i\)</span> in segment <span class="math inline">\(s\)</span>. While this calculation might seem unusual, when all is said and done, it is really just the total estimated abundance in the sampled bends (add all sampled bend abundance estimates together) divided by the total length of the sampled bends (add all sampled bend lengths togher) within the river segment, i.e., <span class="math display">\[\hat{d}_s=\frac{\sum_{j \epsilon J} \hat{N}_{i,s}}{\sum_{j \epsilon J} L_{i,s}}.\]</span></p>
<p>The weighted mean estimated segment density is then turned into an estimated abundance in the same way it was for the arithmetic mean: by multiplying the estimated segment density by the length of the segment in river kilometers:</p>
<p><span class="math display">\[\hat{N}_s=\hat{d_s}\cdot L_s.\]</span></p>
<!--
$$\hat{N}_s=\frac{\sum_{j \epsilon J} \hat{N}_{i,s}}{\sum_{j \epsilon J} L_{i,s}}\cdot L_s.$$
-->
<p>So for our example, we would weight each bend density by the bend length divided by the total of the bend lengths. We would calculate the weighted mean density as the sum of each bend density multiplied by its weight:</p>
<p><span class="math display">\[\hat{d_s}=10\cdot\frac{3}{27}+9\cdot \frac{5}{27}+2\cdot\frac{7}{27}+3\cdot\frac{12}{27}.\]</span> Notice that this simplifies to: <span class="math display">\[\hat{d_s}=\frac{30}{27}+\frac{45}{27}+\frac{14}{27}+\frac{36}{27} =\frac{30+45+14+36}{27},\]</span> which is the sum of the bend abundances divided by the sum of the bend lengths, i.e., the segment abundance divided by the segment length, which calculates the exact segment density, 4.6296296 fish per rkm. Since the segment density is correct, the segment abundance estimated from it will be correct as well, <span class="math inline">\(\hat{d_s}\cdot L_s=\)</span> (4.6296296)(27)=125 fish.</p>
</div>
<div id="standard-error" class="section level5">
<h5>Standard Error</h5>
<p>For the M<span class="math inline">\(_0\)</span> and M<span class="math inline">\(_t\)</span> estimators the segment level standard error was calculated using the delta method {Powell 2012} for both aggregation approaches. Since non-zero bend level standard errors were not available for the MKA estimator (See MKA estimator description above), segment level standard errors were calculated using the variance in the bend level densities under the given approach: <span class="math display">\[Var(d_{s,i})=\sum_{j\epsilon J}  (\hat{d}_{s,i}-\hat{d_s})\cdot p_{s,i},\]</span> where <span class="math inline">\(p_{s,i}=1/bends_s\)</span> for the arithmetic mean approach and <span class="math inline">\(p_{s,i}=w_{s,i}\)</span> for the weighted mean approach. The standard error is then calculated as the square root of the variance.<br />
<!--we might need to adjust this for comparison: N_s=d_s*RKM which the delta method can be applied to...although same approach above could be applied to all other estimators ignoring their SE's so we should address this somewhere in the discussion.--></p>
</div>
</div>
<div id="aggregating-segment-level-abundanc-to-the-basin-level" class="section level4">
<h4>Aggregating Segment Level Abundanc to the Basin Level</h4>
<p>Segment level estimates were aggregated to the basin level using the weighted mean approach described above with standard errors calculated using the delta method.</p>
</div>
<div id="quantifying-effects-of-management-actions-and-auxiliary-information" class="section level4">
<h4>Quantifying effects of management actions and auxiliary information</h4>
<p>Parameters in capture recapture models can be related to covariates which provide a potential means to quantify the population response to management actions. For example, changes in flow can be related to survival or migration parameters using a logit linear model as$()={{}<em>{0}}+{{}</em>{1}} X+$, where <span class="math inline">\(\theta\)</span> is an estimated parameter (e.g., <span class="math inline">\(\phi\)</span>, <span class="math inline">\(\gamma \prime\)</span>, <span class="math inline">\(\gamma\prime\prime\)</span>), <span class="math inline">\(\beta_0\)</span> is the intercept, <span class="math inline">\({{\beta }_{1}}\)</span> is the effect of covariate <span class="math inline">\(X\)</span>, and $$ is residual error. Additionally, auxiliary information can be used to inform parameter estimates. For example, telemetry can be used to determine whether a pallid sturgeon is in the study area or not and thereby inform estimates of <span class="math inline">\(\gamma \prime\)</span>and <span class="math inline">\(\gamma\prime\prime\)</span>. Overall ability of a capture recapture robust design to use auxiliary information and potential capture population level responses to management actions make this a potentially useful design beyond providing a means to quantify the metrics and targets for sub-objectives 1 and 2.</p>
</div>
<div id="caveats-and-considerations" class="section level4">
<h4>Caveats and considerations</h4>
<p>Monitoring pallid sturgeon in a system as large as the Missouri River is inherently challenging and it is likely that any approaches used will violate an assumption required to estimate demographic rates or population abundance. The previous section provides an overview of the robust design as a monitoring design for pallid sturgeon populations of the Upper and Lower Missouri River. The accurate estimation of population parameters represents a critical component of assessing the system state for pallid sturgeon in the Missouri River and providing key demographic values for evaluating management actions through predictive population modeling. The estimation of these metrics depends on the quality and quantity of data collected from a well-developed sampling design. The optimal design must be cost-efficient, and provide reliable, accurate data.</p>
<p>Implementing an untested design on a large system like the Missouri River could prove costly from the expenditure of time and effort if the selected design performs poorly. Pallid sturgeon populations in the Upper and Lower Missouri Rivers differ (e.g., size and age at maturity, growth rates, life span). The habitats in which they live are also different. The Lower River is characterized by a narrow, self-scouring channel with higher water velocities, especially in the main channel. In contrast, the Yellowstone and Upper Missouri Rivers are characterized by lower velocities, shallower depths, and a more natural channel form. Differences between the two Missouri River portions has shown that the most effective sampling methodologies and potential strategies also differ significantly and therefore necessitate that the mark-recapture sample designs be tailored to each population. Provisional capture recapture population monitoring designs need to be evaluated by simulation modeling to identify the optimal design (that is, tradeoffs between precision, bias, and cost) and provide proof of concept before testing or implementing in the field as part of a level 1 science effort and adjusted periodically to improve the design so that it more effectively meets the monitoring and species objectives.</p>
<!--
Applications of Capture-Recapture Robust Design to PSPAP

The fundamental species objective identified by the USFWS for the pallid 
sturgeon is: Avoid jeopardizing the continued existence of the pallid 
sturgeon from the US Army Corps of Engineers actions on the Missouri 
River. Means to achieve this fundamental objective included increasing 
pallid sturgeon recruitment and maintaining or increasing current 
population levels. 

The means to achieve the fundamental objective are specified as 2 
sub-objectives with quantifiable metrics and targets as: 

1. Increase pallid sturgeon recruitment to age 1
Metric:  Catch rates of age 2 and 3 year-old pallid sturgeon.  
Target: Short-term: recruitment; long-term: projection from population 
models of an annual egg to age-1 survival rate > 0.03. 

2. Maintain or increase numbers of pallid sturgeon until sufficient and 
sustained natural recruitment occur. 

Metric:  Catch rate of all size classes 
Target: Viable population size necessary to successfully overcome 
recruitment bottleneck. Minimum of 5000 adults in each management unit. 


While a catch per unit effort based approach to population monitoring 
may be used to calculate the metrics for sub-objective 1 and 2 it fails 
to estimate sub-objective targets. Specifically, CPUE is a relative 
index of population abundance and therefore it may document recruitment 
if age-0 and age-1 pallid sturgeon are captured but it does not estimate 
early life history survival rates. Absolute population estimates cannot 
be achieved unless gear-specified catchability coefficient exists or can 
be estimated to link catch and effort to predict abundance 
as:$Abundance=Catch/ (Effort\cdot Catchability)$. Catchability 
coefficients are difficult to estimate, unlikely to be constant (i.e., 
gear-specific catchability varies among habitat type, season, fish 
species), and assumed to be constant across abundance levels. 
Catchability assumptions have received some scrutiny through 
meta-analysis of multiple fish stocks which suggest that fish stocks 
exhibit a curvilinear relationship of catchability with abundance, most 
commonly exhibiting a phenomenon known as hyperstability, where CPUE 
remains while abundance declines (Harley et al. 2001). It should be 
noted that gear-specific catchabilities have not been estimated for 
pallid sturgeon. The consequences of violating CPUE assumptions are 
uncertain. Despite this uncertainty, the CPUE based PSPAP has been 
successful in achieving PSPAP objectives, however, modifications will be 
needed to achieve sub-objective 1 and 2. 


Modifying the existing PSPAP program will ideally maintain a degree of 
compatibility with existing data while providing population level 
estimates of recruitment, trend, and abundance to achieve the metrics 
and targets specified in sub-objectives 1 and 2. Compatibility with 
existing PSPAP data can be achieved by maintaining the existing sampling 
framework where each management unit is divided into segments, river 
segments divided into bends, and habitat units sampled with each bend. 
Additionally, continued use of current PSPAP standard gear types defined 
in Welker et al. (2016), which have been identified over the duration of 
the PSPAP to be effective, will potentially maintain compatibility with 
existing PSPAP data. A significant modification will be required to 
estimate population abundance, specifically the use of a 
capture-recapture estimator to estimate demographic rates and abundance. 

Several capture-recapture estimators exist to estimate abundance, 
demographic rates, as well as abundance and demographic rates. A capture 
recapture estimator that simultaneously estimates demographic rates and 
abundance can potentially achieve metrics and targets specified in 
sub-objectives 1 and 2. Historically, a Jolly-Seber model, was used to 
simultaneously estimate abundance and survival from recapture of marked 
individuals from singular capture occasions over time (Jolly 1963, 1965, 
Seber 1965). However, the lack of multiple within occasion recapture 
attempts required potentially unrealistic assumptions to estimate 
capture probability. Some of these assumptions can be relaxed by 
sophisticated model formulations or fitting the capture recapture model 
as a Bayesian state space model, which has been done for pallid sturgeon 
in the RPMA 4 by Wu and Holan (2016). Alternatively, using multiple 
recapture efforts within a sampling occasion allows direct estimation of 
capture probability as well as abundance and survival, which was 
described by Pollock (1982) and referred to as the robust design. 

The robust design frame work has been applied across a wide range of 
taxa to estimate demographic rates and population abundance. Its use has 
been extended to studies of species occurrence (i.e., occupancy models; 
MacKenzie et al. 2002, Tyre et al. 2003) and abundance (N-mixture 
models; Royle 2004b, Royle 2004a) of unmarked individuals. The robust 
design provides a rigorous framework that allows for the estimation of 
relevant demographic rates and abundance using marked individuals. As 
originally described by Pollock (1982), a robust design consists of 
primary sampling occasions with secondary sampling occasions nested with 
the primary sampling occasion (Figure 1). Primary occasions are spaced 
temporally to capture processes like survival and growth. Secondary 
occasions occur over a short time frame, short enough that closure of 
the population from demographic processes (i.e., recruitment, mortality, 
immigration, emigration) can be assumed. The secondary sampling 
occasions provide multiple opportunities for individuals to be captured 
and thereby allowing capture probability and abundance to be estimated. 

Application of robust design to Pallid Sturgeon
The use of a robust design capture recapture approach to estimate 
Missouri River pallid sturgeon abundance, and demographic rates are not 
novel. The first application was Steffensen et al. (2012) as part of the 
annual brood stock collection in segment 9. Similarly, Winders and 
Steffensen (2014) used a robust design to estimate abundance and 
demographic rates for a portion of segment 10 using broodstock 
collection data. In both studies, pallid sturgeon were captured by 
setting multiple trotlines at random locations in the study area over a 
short period. The annual brood stock sampling was the primary occasion 
and daily capture efforts were the secondary occasions in both studies. 
Given the study design, survival was estimated over the open period 
(i.e., between annual broodstock collection events). Capture probability 
was estimated for each daily effort within the primary period and 
abundance during the closed period (i.e., broodstock collection). 
Additionally, both studies were able to estimate movement parameters 
that account for pallid sturgeon leaving or arriving in the study area 
between closed periods. 


Specific parameters estimated by the robust design
There are variations of the robust design that estimate varying 
parameters. The most commonly used version, as well as the version used 
by Steffensen et al. (2012) and Winders and Steffensen (2014) is the 
version that estimates 6 parameters. Specifically these parameters are: 

* $\varphi $: the probability of surviving between primary occasions, 
* $\gamma^{\prime}$:  the probability of being outside the study area and unavailable for capture during the primary occasions given the animal was not present during the previous primary occasions given it survives to the current occasion (Figure 2),
* $\gamma^{\prime\prime}$:  is the probability of being outside the study area and unavailable for capture during the primary occasions given the animal was present during the previous primary occasions given it survives to the current occasion (Figure 2),
* $c$ is the initial capture probability
* $p$ is the recapture probability, and 
* $f_0$ is number of unobserved individuals.  

Depending on the situation the number of parameters estimated can be 
reduced by assuming initial capture probability is equal to recapture 
probability where $c=p$. Similarly, ${{\gamma }^{\prime }}$ and 
$\gamma^{\prime\prime}$ can be specified to represent hypotheses about 
immigration and emigration processes. For example, even flow of fish in 
and out of the systems can be specified by imposing equality of 
immigration and emigration terms where ${{\gamma }^{\prime }}={{\gamma 
}^{\prime \prime }}$. Population abundance ($N$) at each time period is 
a derived parameter calculated as: $N={{f}_{0}}+M$ where, $M$ is the 
number of marked fish. Uncerainty around parameter estimates derived 
quantities can be estimated by profile likelihood and use of the delta 
method if estimated by maximizing the likelihood of the model given the 
data (Hilborn and Mangel 1997, Powell 2012). Uncertainty can also be 
quantified simultaneously for estimated and derived parameters if fit by 
MCMC using a Bayesian approach. 



Achieving sub-objective metrics and targets

Recruitment

When capture recapture histories are viewed in reverse order 
recruitment can be estimated using what is referred to as a Pradel model 
(Pradel 1996). This model relies on being able to differentiate recruits 
based off of size or age which works well for fish populations. 
Therefore there are 2 processes in which a pallid sturgeon can be 
initially captured: 1) it is a new recruit and was not vulnerable to 
capture and 2) the pallid sturgeon was vulnerable to capture but not 
captured. The differentiating the 2 outcomes can be informed by size to 
improve recruitment estimates. 

Trend

While not commonly employed in fisheries literature the robust design 
can estimate population growth rate ($\lambda$). In particular, by 
running capture histories backwards estimates the probability a pallid 
sturgeon was present in the previous year given it was present in the 
current year which is the per capita rate of additions to the population 
($f$), or the number of individuals entering the population between 
primary occasions. Survival rate ($\varphi $) can be estimated, and by 
running them forward, survival can be estimated. Trend evaluated as 
population growth rate is derived from model estimates as$\lambda 
=\varphi \text{+}f$ and uncertainty can be estimated using the 
previously described approaches for$N$. 

Abundance

Absolute abundance estimates are important to ongoing adaptive 
management and recovery because species recovery sub-objective 2 is 
specified as abundance. The robust design for capture recapture provides 
the necessary within primary occasion replication to reliably estimate 
capture probabilities ($c,p$) and then estimate $N$ given the number of 
fish captured and the capture probability. Given that the capture 
recapture design is potentially using 2 or more temporal replicates 
within each bend then unadjusted catch numbers may be comparable to 
existing PSPAP CPUE data. 


Quantifying effects of management actions and auxiliary information

Parameters in capture recapture models can be related to covariates 
which provide a potential means to quantify the population response to 
management actions. For example, changes in flow can be related to 
survival or migration parameters using a logit linear model 
as$\operatorname{logit}(\theta )={{\beta }_{0}}+{{\beta }_{1}}\cdot 
X+\epsilon $, where $\theta$ is an estimated parameter (e.g., $\phi$, 
$\gamma \prime$, $\gamma\prime\prime$), $\beta_0$ is the intercept, 
${{\beta }_{1}}$ is the effect of covariate $X$, and $\epsilon $ is 
residual error. Additionally, auxiliary information can be used to 
inform parameter estimates. For example, telemetry can be used to 
determine whether a pallid sturgeon is in the study area or not and 
thereby inform estimates of $\gamma \prime$and $\gamma\prime\prime$. 
Overall ability of a capture recapture robust design to use auxiliary 
information and potential capture population level responses to 
management actions make this a potentially useful design beyond 
providing a means to quantify the metrics and targets for sub-objectives 
1 and 2. 


Caveats and considerations
Monitoring pallid sturgeon in a system as large as the Missouri River is 
inherently challenging and it is likely that any approached used will 
violate an assumption required to estimate demographic rates or 
population abundance. The previous section provides an overview of the 
robust design as a monitoring design for pallid sturgeon populations of 
the Upper and Lower Missouri River. The accurate estimation of 
population parameters represents a critical component of assessing the 
system state for pallid sturgeon in the Missouri River and providing key 
demographic values for evaluating management actions through predictive 
population modeling. The estimation of these metrics depends on the 
quality and quantity of data collected from a well-developed sampling 
design. The optimal design must be cost-efficient, and provide reliable, 
accurate data. 

Implementing an untested design on a large system like the Missouri 
River could prove costly from the expenditure of time and effort if the 
selected design performs poorly. Pallid sturgeon populations in the 
Upper and Lower Missouri Rivers differ (e.g., size and age at maturity, 
growth rates, life span). The habitats in which they live are also 
different. The Lower River is characterized by a narrow, self-scouring 
channel with higher water velocities, especially in the main channel. In 
contrast, the Yellowstone and Upper Missouri Rivers are characterized by 
lower velocities, shallower depths, and a more natural channel form. 
Differences between the two Missouri River portions has shown that the 
most effective sampling methodologies and potential strategies also 
differ significantly and therefore necessitate that the mark-recapture 
sample designs be tailored to each population. Provisional capture 
recapture population monitoring designs need to be evaluated by 
simulation modeling to identify the optimal design (that is, tradeoffs 
between precision, bias, and cost) and provide proof of concept before 
testing or implementing in the field as part of a level 1 science effort 
and adjusted periodically to improve the design so that it more 
effectively meets the monitoring and species objectives. 
-->
</div>
</div>



<!-- disqus -->
 <div id="disqus_thread" class="standardPadding"></div>
    <script type="text/javascript">
      $(document).ready(function() {
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'pspapv2'; // required: replace example with your forum shortname
        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            // create disqus script tag
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            // determine container
            var container = document.getElementsByTagName('body')[0] || document.getElementsByTagName('head')[0];
            // append script tag enclosed by google indexing suppression comment
            container.appendChild(document.createComment('googleoff: all'));
            container.appendChild(dsq);
            container.appendChild(document.createComment('googleon: all'));
        })();
      });
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    
      </div> <!-- articleBandContent -->
</div> <!-- pageContent -->

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-99786286-1', 'auto');
  ga('send', 'pageview');

</script>



</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
